for /f "tokens=4-7 delims=[.] " %%i in ('ver') do @(if "%%i" equ "Version" (if "%%j.%%k" equ "6.3" (set legacy=1) else (if "%%j.%%k" equ "6.2" (set legacy=1) else (if "%%j.%%k" equ "6.1" (set legacy=1) else (if "%%j.%%k" equ "6.0" (set legacy=1) else (if "%%j.%%k" equ "5.2" (set legacy=1) else (if "%%j.%%k" equ "5.1" (set legacy=1) else (if "%%j.%%k" equ "5.0" (set legacy=1)))))))) else (if "%%i.%%j" equ "6.3" (set legacy=1) else (if "%%i.%%j" equ "6.2" (set legacy=1) else (if "%%i.%%j" equ "6.1" (set legacy=1) else (if "%%i.%%j" equ "6.0" (set legacy=1) else (if "%%i.%%j" equ "5.2" (set legacy=1) else (if "%%i.%%j" equ "5.1" (set legacy=1) else (if "%%i.%%j" equ "5.0" (set legacy=1)))))))))
if "%legacy%" equ "1" (ansicon -p) else (if /i "%1" equ "--legacy" (ansicon -p))
set `r=[0m&set `b=[1m&set `u=[4m&set `i=[7m&set fg`black-=[30m&set fg`red-=[31m&set fg`green-=[32m&set fg`yellow-=[33m&set fg`blue-=[34m&set fg`magenta-=[35m&set fg`cyan-=[36m&set fg`white-=[37m&set fg`black=[90m&set fg`red=[91m&set fg`green=[92m&set fg`yellow=[93m&set fg`blue=[94m&set fg`magenta=[95m&set fg`cyan=[96m&set fg`white=[97m&set bg`black-=[40m&set bg`red-=[41m&set bg`green-=[42m&set bg`yellow-=[43m&set bg`blue-=[44m&set bg`magenta-=[45m&set bg`cyan-=[46m&set bg`white-=[47m&set bg`black=[100m&set bg`red=[101m&set bg`green=[102m&set bg`yellow=[103m&set bg`blue=[104m&set bg`magenta=[105m&set bg`cyan=[106m&set bg`white=[107m